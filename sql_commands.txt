Copyright (C) 2011 Kyle Evans <kyledevans@gmail.com>

Released under the GPL version 2 only.

-------------------------------------------------------

SELECT patients.id, patients.last, patients.first, patients.dob, drugs.name, drugs.form, drugs.strength, prescriptions.amount, prescriptions.written, prescriptions.filled, shipments.lot
FROM prescriptions
JOIN patients ON prescriptions.patient_id = patients.id
JOIN drugs ON prescriptions.drug_id = drugs.id
JOIN shipments ON prescriptions.shipment_id = shipments.id
WHERE drugs.name = SOMEVAR
AND shipments.lot = SOMEVAR
AND prescriptions.filled = SOMEVAR
AND patients.last = SOMEVAR
AND patients.first = SOMEVAR
AND patients.dob = SOMEVAR;

SELECT drugs.name, drugs.ndc, drugs.form, drugs.strength, drugs.amount, SUM( shipments.product_left )
FROM drugs
JOIN shipments ON drugs.id = shipments.drug_id
WHERE drugs.name LIKE SOME_VAR
AND drugs.active = SOME_VAR
GROUP BY shipments.drug_id

SELECT drugs.name, drugs.form, drugs.strength, drugs.amount, shipments.expiration, shipments.lot, shipments.product_count, shipments.product_left
FROM shipments
JOIN drugs ON shipments.drug_id = drugs.id
WHERE drugs.name LIKE SOME_VAR
AND shipments.lot LIKE SOME_VAR
AND shipments.product_left > 0
AND drugs.active = 1
AND shipments.expiration > CURDATE();